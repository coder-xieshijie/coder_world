

![é¢è¯•å®˜](https://coder-xieshijie-img-1253784930.cos.ap-beijing.myqcloud.com/img/2024/é¢è¯•å®˜_861e323fc0616911b75a408abc40af09.jpg)




> å“ˆå–½ï¼Œå¤§å®¶å¥½ğŸ‰ï¼Œæˆ‘æ˜¯**ä¸–æ°**ã€‚
> 
> 
> æœ¬æ–‡æˆ‘ä¸ºå¤§å®¶ä»‹ç»é¢è¯•å®˜ç»å¸¸è€ƒå¯Ÿçš„**ã€ŒJavaå†…å­˜æ¨¡å‹JMMç›¸å…³å†…å®¹ã€**


## é¢è¯•è¿ç¯call

1. ä»€ä¹ˆæ˜¯Javaå†…å­˜æ¨¡å‹(JMM)? ä¸ºä»€ä¹ˆéœ€è¦JMM?
2. Javaçº¿ç¨‹çš„å·¥ä½œå†…å­˜å’Œä¸»å†…å­˜å„è‡ªçš„ä½œç”¨?
3. Javaç¼“å­˜ä¸€è‡´æ€§é—®é¢˜?
4. Javaçš„å¹¶å‘ç¼–ç¨‹é—®é¢˜?



è¦æƒ³ç†è§£é€å½» JMMï¼ˆJava å†…å­˜æ¨¡å‹ï¼‰ï¼Œæˆ‘ä»¬å…ˆè¦ä» **ã€ç¡¬ä»¶å†…å­˜ç»“æ„ã€** è¯´èµ·ã€‚è®©æˆ‘ä»¬å¼€å§‹å§ï¼ğŸ‰ğŸ‰ğŸ‰



## 1. ç¡¬ä»¶å†…å­˜ç»“æ„

### 1.1 CPU ç¼“å­˜æ¨¡å‹

![img](https://coder-xieshijie-img-1253784930.cos.ap-beijing.myqcloud.com/img/2024/java-memory-model-4_bfec7abd0e07f348c4ef51812b5331b0.png)





**(1)CPU Register**

CPU Register  ä¹Ÿå°±æ˜¯ **CPU å¯„å­˜å™¨**ã€‚CPU å¯„å­˜å™¨æ˜¯ **CPU å†…éƒ¨é›†æˆ**çš„ï¼Œåœ¨å¯„å­˜å™¨ä¸Šæ‰§è¡Œæ“ä½œçš„æ•ˆç‡è¦æ¯”åœ¨ä¸»å­˜ä¸Šé«˜å‡ºå‡ ä¸ªæ•°é‡çº§ã€‚

**(2)CPU Cache Memory**

CPU Cache Memory ä¹Ÿå°±æ˜¯ **CPU é«˜é€Ÿç¼“å­˜**ï¼Œç›¸å¯¹äºå¯„å­˜å™¨æ¥è¯´ï¼Œé€šå¸¸ä¹Ÿå¯ä»¥æˆä¸º L2 äºŒçº§ç¼“å­˜ã€‚ç›¸å¯¹äºç¡¬ç›˜è¯»å–é€Ÿåº¦æ¥è¯´å†…å­˜è¯»å–çš„æ•ˆç‡éå¸¸é«˜ï¼Œä½†æ˜¯ä¸ CPU è¿˜æ˜¯ç›¸å·®æ•°é‡çº§ï¼Œæ‰€ä»¥åœ¨ CPU å’Œä¸»å­˜é—´å¼•å…¥äº†å¤šçº§ç¼“å­˜ã€‚CPU ç¼“å­˜åˆ™æ˜¯ä¸ºäº†**è§£å†³ CPU å¤„ç†é€Ÿåº¦å’Œå†…å­˜å¤„ç†é€Ÿåº¦ä¸å¯¹ç­‰**çš„é—®é¢˜ã€‚

**(3)Main Memory**

Main Memory å°±æ˜¯**ä¸»å­˜**ï¼Œä¸»å­˜æ¯” L1ã€L2 ç¼“å­˜è¦å¤§å¾ˆå¤šã€‚



### 1.2 ç¼“å­˜ä¸€è‡´æ€§é—®é¢˜

ç”±äºä¸»å­˜ä¸ CPU å¤„ç†å™¨çš„è¿ç®—èƒ½åŠ›ä¹‹é—´æœ‰**æ•°é‡çº§çš„å·®è·**ï¼Œæ‰€ä»¥åœ¨ä¼ ç»Ÿè®¡ç®—æœºå†…å­˜æ¶æ„ä¸­ä¼šå¼•å…¥**é«˜é€Ÿç¼“å­˜**æ¥ä½œä¸ºä¸»å­˜å’Œå¤„ç†å™¨ä¹‹é—´çš„ç¼“å†²ã€‚å…ˆå¤åˆ¶ä¸€ä»½æ•°æ®åˆ° CPU Cache ä¸­ï¼Œå½“ CPU éœ€è¦ç”¨åˆ°çš„æ—¶å€™å°±å¯ä»¥ç›´æ¥ä» CPU Cache ä¸­è¯»å–æ•°æ®ï¼Œå½“è¿ç®—å®Œæˆåï¼Œå†å°†è¿ç®—å¾—åˆ°çš„æ•°æ®å†™å› Main Memory ä¸­ã€‚

ä½†æ˜¯ï¼Œè¿™æ ·å­˜åœ¨ **å†…å­˜ç¼“å­˜ä¸ä¸€è‡´æ€§çš„é—®é¢˜** ï¼æ¯”å¦‚æˆ‘æ‰§è¡Œä¸€ä¸ª i++ æ“ä½œçš„è¯ï¼Œå¦‚æœä¸¤ä¸ªçº¿ç¨‹åŒæ—¶æ‰§è¡Œçš„è¯ï¼Œå‡è®¾ä¸¤ä¸ªçº¿ç¨‹ä» CPU Cache ä¸­è¯»å–çš„ i=1ï¼Œä¸¤ä¸ªçº¿ç¨‹åšäº† i++ è¿ç®—å®Œä¹‹åå†å†™å› Main Memory ä¹‹å i=2ï¼Œè€Œæ­£ç¡®ç»“æœåº”è¯¥æ˜¯ i=3ã€‚

CPU ä¸ºäº†è§£å†³å†…å­˜ç¼“å­˜ä¸ä¸€è‡´æ€§é—®é¢˜å¯ä»¥é€šè¿‡**åˆ¶å®šç¼“å­˜ä¸€è‡´åè®®ï¼ˆæ¯”å¦‚ [MESI åè®®open in new window]ï¼‰**æˆ–è€…å…¶ä»–æ‰‹æ®µæ¥è§£å†³ã€‚ è¿™ä¸ªç¼“å­˜ä¸€è‡´æ€§åè®®æŒ‡çš„æ˜¯åœ¨ CPU é«˜é€Ÿç¼“å­˜ä¸ä¸»å†…å­˜äº¤äº’çš„æ—¶å€™éœ€è¦éµå®ˆçš„åŸåˆ™å’Œè§„èŒƒã€‚ä¸åŒçš„ CPU ä¸­ï¼Œä½¿ç”¨çš„ç¼“å­˜ä¸€è‡´æ€§åè®®é€šå¸¸ä¹Ÿä¼šæœ‰æ‰€ä¸åŒã€‚



![img](https://coder-xieshijie-img-1253784930.cos.ap-beijing.myqcloud.com/img/2024/20d39e9d5cc81017f0ae660877718450_565d8b08159d7afecaaba504813039ee.png)



### 1.3 æŒ‡ä»¤é‡æ’åº

> **ä»€ä¹ˆæ˜¯æŒ‡ä»¤é‡æ’åºï¼Ÿ** ç®€å•æ¥è¯´å°±æ˜¯ç³»ç»Ÿåœ¨æ‰§è¡Œä»£ç çš„æ—¶å€™å¹¶ä¸ä¸€å®šæ˜¯æŒ‰ç…§ä½ å†™çš„ä»£ç çš„é¡ºåºä¾æ¬¡æ‰§è¡Œã€‚

å¸¸è§çš„æŒ‡ä»¤é‡æ’åºæœ‰ä¸‹é¢ 2 ç§æƒ…å†µï¼š

- **ç¼–è¯‘å™¨ä¼˜åŒ–é‡æ’**ï¼šç¼–è¯‘å™¨ï¼ˆåŒ…æ‹¬ JVMã€JIT ç¼–è¯‘å™¨ç­‰ï¼‰åœ¨ä¸æ”¹å˜å•çº¿ç¨‹ç¨‹åºè¯­ä¹‰çš„å‰æä¸‹ï¼Œé‡æ–°å®‰æ’è¯­å¥çš„æ‰§è¡Œé¡ºåºã€‚
- **æŒ‡ä»¤å¹¶è¡Œé‡æ’**ï¼šç°ä»£å¤„ç†å™¨é‡‡ç”¨äº†æŒ‡ä»¤çº§å¹¶è¡ŒæŠ€æœ¯(Instruction-Level Parallelismï¼ŒILP)æ¥å°†å¤šæ¡æŒ‡ä»¤é‡å æ‰§è¡Œã€‚å¦‚æœä¸å­˜åœ¨æ•°æ®ä¾èµ–æ€§ï¼Œå¤„ç†å™¨å¯ä»¥æ”¹å˜è¯­å¥å¯¹åº”æœºå™¨æŒ‡ä»¤çš„æ‰§è¡Œé¡ºåºã€‚
- **å†…å­˜ç³»ç»Ÿçš„é‡æ’åº**ï¼šç”±äºå¤„ç†å™¨ä½¿ç”¨ç¼“å­˜å’Œè¯»å†™ç¼“å†²åŒºï¼Œè¿™ä½¿å¾—åŠ è½½å’Œå­˜å‚¨æ“ä½œçœ‹ä¸Šå»å¯èƒ½æ˜¯åœ¨ä¹±åºæ‰§è¡Œã€‚

![img](https://coder-xieshijie-img-1253784930.cos.ap-beijing.myqcloud.com/img/2024/8659b033108f907b9ef4f60940feb6e9_148b5a7e0cc167e333d6f5a7997fcf1a.png)

Java æºä»£ç ä¼šç»å† **ç¼–è¯‘å™¨ä¼˜åŒ–é‡æ’ â€”> æŒ‡ä»¤å¹¶è¡Œé‡æ’ â€”> å†…å­˜ç³»ç»Ÿé‡æ’** çš„è¿‡ç¨‹ï¼Œæœ€ç»ˆæ‰å˜æˆæ“ä½œç³»ç»Ÿå¯æ‰§è¡Œçš„æŒ‡ä»¤åºåˆ—ã€‚



----



## 2. Javaå†…å­˜æ¨¡å‹



### 2.1 Javaå†…å­˜ä¸ç¡¬ä»¶å†…å­˜



ä¹‹å‰è®² JVM è¿è¡Œæ—¶å†…å­˜åŒºåŸŸæ—¶ï¼ŒèŠåˆ° **JVM åˆ†ä¸ºæ ˆã€å †**ç­‰ï¼Œè¿™äº›éƒ½æ˜¯ JVM å®šä¹‰çš„æ¦‚å¿µã€‚åœ¨ä¼ ç»Ÿçš„**ç¡¬ä»¶å†…å­˜æ¶æ„ä¸­æ˜¯æ²¡æœ‰æ ˆå’Œå †**è¿™ç§æ¦‚å¿µã€‚ä»å›¾ä¸­å¯ä»¥çœ‹å‡º**æ ˆå’Œå †æ—¢å­˜åœ¨äºé«˜é€Ÿç¼“å­˜ä¸­åˆå­˜åœ¨äºä¸»å†…å­˜**ä¸­ï¼Œæ‰€ä»¥Javaå†…å­˜å’Œç¡¬ä»¶å†…å­˜æ²¡æœ‰ç›´æ¥çš„å…³ç³»ã€‚



![img](https://coder-xieshijie-img-1253784930.cos.ap-beijing.myqcloud.com/img/2024/java-memory-model-5_15c2ce1606ccea46e1e95c392f853ad0.png)



### 2.2 Javaå†…å­˜ä¸ä¸»å†…å­˜



(1) Java å†…å­˜æ¨¡å‹è§„å®šæ‰€æœ‰çš„å˜é‡éƒ½**å­˜å‚¨åœ¨ä¸»å†…å­˜**ä¸­ï¼Œæ¯æ¡çº¿ç¨‹éƒ½æœ‰è‡ªå·±çš„å·¥ä½œå†…å­˜ã€‚

(2) çº¿ç¨‹çš„**å·¥ä½œå†…å­˜**ä¸­ä¿å­˜äº†è¢«è¯¥çº¿ç¨‹ä½¿ç”¨åˆ°çš„å˜é‡çš„**ä¸»å†…å­˜å‰¯æœ¬æ‹·è´**ï¼Œçº¿ç¨‹å¯¹å˜é‡çš„æ‰€æœ‰æ“ä½œï¼ˆè¯»å–ã€èµ‹å€¼ç­‰ï¼‰éƒ½**å¿…é¡»åœ¨å·¥ä½œå†…å­˜ä¸­**è¿›è¡Œï¼Œè€Œä¸èƒ½ç›´æ¥è¯»å†™ä¸»å†…å­˜ä¸­çš„å˜é‡ã€‚

(3) ä¸åŒçº¿ç¨‹ä¹‹é—´ä¹Ÿ**æ— æ³•ç›´æ¥è®¿é—®å¯¹æ–¹å·¥ä½œå†…å­˜**ä¸­çš„å˜é‡ï¼Œçº¿ç¨‹é—´å˜é‡å€¼çš„ä¼ é€’éƒ½éœ€è¦é€šè¿‡ä¸»å†…å­˜æ¥å®Œæˆã€‚





![jmm](https://coder-xieshijie-img-1253784930.cos.ap-beijing.myqcloud.com/img/2024/jmm_2bb08f233da3cb09dcee7c9072892528.png)



- **ä¸»å†…å­˜**ï¼šæ‰€æœ‰çº¿ç¨‹åˆ›å»ºçš„å®ä¾‹å¯¹è±¡éƒ½å­˜æ”¾åœ¨ä¸»å†…å­˜ä¸­ï¼Œä¸ç®¡è¯¥å®ä¾‹å¯¹è±¡æ˜¯**æˆå‘˜å˜é‡**ï¼Œè¿˜æ˜¯**å±€éƒ¨å˜é‡**ï¼Œ**ç±»ä¿¡æ¯**ã€**å¸¸é‡**ã€**é™æ€å˜é‡**éƒ½æ˜¯æ”¾åœ¨ä¸»å†…å­˜ä¸­ã€‚ä¸ºäº†è·å–æ›´å¥½çš„è¿è¡Œé€Ÿåº¦ï¼Œè™šæ‹ŸæœºåŠç¡¬ä»¶ç³»ç»Ÿå¯èƒ½ä¼šè®©å·¥ä½œå†…å­˜ä¼˜å…ˆå­˜å‚¨äºå¯„å­˜å™¨å’Œé«˜é€Ÿç¼“å­˜ä¸­ã€‚

- **æœ¬åœ°å†…å­˜**ï¼šæ¯ä¸ªçº¿ç¨‹éƒ½æœ‰ä¸€ä¸ªç§æœ‰çš„æœ¬åœ°å†…å­˜ï¼Œæœ¬åœ°å†…å­˜**å­˜å‚¨äº†è¯¥çº¿ç¨‹ä»¥è¯» / å†™å…±äº«å˜é‡çš„å‰¯æœ¬**ã€‚æ¯ä¸ªçº¿ç¨‹åªèƒ½æ“ä½œè‡ªå·±æœ¬åœ°å†…å­˜ä¸­çš„å˜é‡ï¼Œæ— æ³•ç›´æ¥è®¿é—®å…¶ä»–çº¿ç¨‹çš„æœ¬åœ°å†…å­˜ã€‚å¦‚æœçº¿ç¨‹é—´éœ€è¦é€šä¿¡ï¼Œå¿…é¡»é€šè¿‡ä¸»å†…å­˜æ¥è¿›è¡Œã€‚æœ¬åœ°å†…å­˜æ˜¯ **JMM æŠ½è±¡å‡ºæ¥çš„ä¸€ä¸ªæ¦‚å¿µ**ï¼Œå¹¶ä¸çœŸå®å­˜åœ¨ï¼Œå®ƒæ¶µç›–äº†ç¼“å­˜ã€å†™ç¼“å†²åŒºã€å¯„å­˜å™¨ä»¥åŠå…¶ä»–çš„ç¡¬ä»¶å’Œç¼–è¯‘å™¨ä¼˜åŒ–ã€‚



> ä¸ºäº†æ›´å¥½çš„æ§åˆ¶ä¸»å†…å­˜å’Œæœ¬åœ°å†…å­˜çš„äº¤äº’ï¼ŒJava å†…å­˜æ¨¡å‹å®šä¹‰äº†**å…«ç§æ“ä½œ**æ¥å®ç°:

**ã€ä¸»å†…å­˜ã€**

- **lockï¼šé”å®š**ã€‚ä½œç”¨äºä¸»å†…å­˜çš„å˜é‡ï¼ŒæŠŠä¸€ä¸ªå˜é‡æ ‡è¯†ä¸ºä¸€æ¡çº¿ç¨‹ç‹¬å çŠ¶æ€

- **unlockï¼šè§£é”**ã€‚ä½œç”¨äºä¸»å†…å­˜å˜é‡ï¼ŒæŠŠä¸€ä¸ªå¤„äºé”å®šçŠ¶æ€çš„å˜é‡é‡Šæ”¾å‡ºæ¥ï¼Œé‡Šæ”¾åçš„å˜é‡æ‰å¯ä»¥è¢«å…¶ä»–çº¿ç¨‹é”å®š

- **readï¼šè¯»å–**ã€‚ä½œç”¨äºä¸»å†…å­˜å˜é‡ï¼ŒæŠŠä¸€ä¸ªå˜é‡å€¼ä»ä¸»å†…å­˜ä¼ è¾“åˆ°çº¿ç¨‹çš„å·¥ä½œå†…å­˜ä¸­ï¼Œä»¥ä¾¿éšåçš„loadåŠ¨ä½œä½¿ç”¨

- **writeï¼šå†™å…¥**ã€‚ä½œç”¨äºä¸»å†…å­˜çš„å˜é‡ï¼Œå®ƒæŠŠstoreæ“ä½œä»å·¥ä½œå†…å­˜ä¸­ä¸€ä¸ªå˜é‡çš„å€¼ä¼ é€åˆ°ä¸»å†…å­˜çš„å˜é‡ä¸­

**ã€å·¥ä½œå†…å­˜ã€**

- **loadï¼šè½½å…¥**ã€‚ä½œç”¨äºå·¥ä½œå†…å­˜çš„å˜é‡ï¼Œå®ƒæŠŠreadæ“ä½œä»ä¸»å†…å­˜ä¸­å¾—åˆ°çš„å˜é‡å€¼æ”¾å…¥å·¥ä½œå†…å­˜çš„å˜é‡å‰¯æœ¬ä¸­

- **useï¼šä½¿ç”¨**ã€‚ä½œç”¨äºå·¥ä½œå†…å­˜çš„å˜é‡ï¼ŒæŠŠå·¥ä½œå†…å­˜ä¸­çš„ä¸€ä¸ªå˜é‡å€¼ä¼ é€’ç»™æ‰§è¡Œå¼•æ“ï¼Œæ¯å½“è™šæ‹Ÿæœºé‡åˆ°ä¸€ä¸ªéœ€è¦ä½¿ç”¨å˜é‡çš„å€¼çš„å­—èŠ‚ç æŒ‡ä»¤æ—¶å°†ä¼šæ‰§è¡Œè¿™ä¸ªæ“ä½œ

- **assignï¼šèµ‹å€¼**ã€‚ä½œç”¨äºå·¥ä½œå†…å­˜çš„å˜é‡ï¼Œå®ƒæŠŠä¸€ä¸ªä»æ‰§è¡Œå¼•æ“æ¥æ”¶åˆ°çš„å€¼èµ‹å€¼ç»™å·¥ä½œå†…å­˜çš„å˜é‡ï¼Œæ¯å½“è™šæ‹Ÿæœºé‡åˆ°ä¸€ä¸ªç»™å˜é‡èµ‹å€¼çš„å­—èŠ‚ç æŒ‡ä»¤æ—¶æ‰§è¡Œè¿™ä¸ªæ“ä½œ

- **storeï¼šå­˜å‚¨**ã€‚ä½œç”¨äºå·¥ä½œå†…å­˜çš„å˜é‡ï¼ŒæŠŠå·¥ä½œå†…å­˜ä¸­çš„ä¸€ä¸ªå˜é‡çš„å€¼ä¼ é€åˆ°ä¸»å†…å­˜ä¸­ï¼Œä»¥ä¾¿éšåçš„writeçš„æ“ä½œ

  

----

## 3. å†èŠå¹¶å‘ç¼–ç¨‹

ç†Ÿæ‚‰ Java å¹¶å‘ç¼–ç¨‹çš„åŒå­¦è‚¯å®šå¯¹è¿™ä¸‰ä¸ªé—®é¢˜å¾ˆç†Ÿæ‚‰ï¼š**ã€å¯è§æ€§é—®é¢˜ã€**ã€**ã€åŸå­æ€§é—®é¢˜ã€**ã€**ã€æœ‰åºæ€§é—®é¢˜ã€**ã€‚

### 3.1 æœ‰åºæ€§

> ç”±äºæŒ‡ä»¤é‡æ’åºé—®é¢˜ï¼Œä»£ç çš„æ‰§è¡Œé¡ºåºæœªå¿…å°±æ˜¯ç¼–å†™ä»£ç æ—¶å€™çš„é¡ºåºã€‚æˆ‘ä»¬ä¸Šé¢è®²é‡æ’åºçš„æ—¶å€™ä¹Ÿæåˆ°è¿‡ï¼š**æŒ‡ä»¤é‡æ’åºå¯ä»¥ä¿è¯ä¸²è¡Œè¯­ä¹‰ä¸€è‡´ï¼Œä½†æ˜¯æ²¡æœ‰ä¹‰åŠ¡ä¿è¯å¤šçº¿ç¨‹é—´çš„è¯­ä¹‰ä¹Ÿä¸€è‡´** ï¼Œæ‰€ä»¥åœ¨å¤šçº¿ç¨‹ä¸‹ï¼ŒæŒ‡ä»¤é‡æ’åºå¯èƒ½ä¼šå¯¼è‡´ä¸€äº›é—®é¢˜ã€‚

åœ¨ Java ä¸­ï¼Œ`volatile` å…³é”®å­—å¯ä»¥ç¦æ­¢æŒ‡ä»¤è¿›è¡Œé‡æ’åºä¼˜åŒ–ã€‚



### 3.2 åŸå­æ€§

> ä¸€æ¬¡æ“ä½œæˆ–è€…å¤šæ¬¡æ“ä½œï¼Œè¦ä¹ˆ**æ‰€æœ‰çš„æ“ä½œå…¨éƒ¨éƒ½å¾—åˆ°æ‰§è¡Œ**å¹¶ä¸”ä¸ä¼šå—åˆ°ä»»ä½•å› ç´ çš„å¹²æ‰°è€Œä¸­æ–­ï¼Œè¦ä¹ˆ**éƒ½ä¸æ‰§è¡Œ**ã€‚

åœ¨ Java ä¸­ï¼Œå¯ä»¥å€ŸåŠ©`synchronized`ã€å„ç§ `Lock` ä»¥åŠå„ç§åŸå­ç±»å®ç°åŸå­æ€§ã€‚



### 3.3 å¯è§æ€§

> å½“ä¸€ä¸ªçº¿ç¨‹å¯¹å…±äº«å˜é‡è¿›è¡Œäº†ä¿®æ”¹ï¼Œé‚£ä¹ˆå¦å¤–çš„çº¿ç¨‹éƒ½æ˜¯**ç«‹å³å¯ä»¥çœ‹åˆ°**ä¿®æ”¹åçš„æœ€æ–°å€¼ã€‚

åœ¨ Java ä¸­ï¼Œå¯ä»¥å€ŸåŠ©`synchronized`ã€`volatile` ä»¥åŠå„ç§ `Lock` å®ç°å¯è§æ€§ã€‚



----



> å‚è€ƒæ–‡ç« 

1. [Java å†…å­˜æ¨¡å‹å¼•å…¥](https://pdai.tech/md/java/jvm/java-jvm-x-introduce.html)

2. [JMMï¼ˆJava å†…å­˜æ¨¡å‹ï¼‰è¯¦è§£](https://javaguide.cn/java/concurrent/jmm.html)

3. [è¯´è¯´ä»€ä¹ˆæ˜¯Javaå†…å­˜æ¨¡å‹ï¼Ÿ](https://www.51cto.com/article/658158.html)

4. [ä» CPU è®²èµ·ï¼Œæ·±å…¥ç†è§£ Java å†…å­˜æ¨¡å‹ï¼ ](https://www.cnblogs.com/chanshuyi/p/deep-insight-of-java-memory-model.html)

